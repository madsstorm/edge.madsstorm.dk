service:
  name: edge-madsstorm-dk
  config:
    accountId: ${env:CLOUDFLARE_ACCOUNT_ID}
    zoneId: ${env:CLOUDFLARE_ZONE_ID}
  
provider:
  name: cloudflare
  
plugins:
  - serverless-cloudflare-workers
  
functions:
  edge-worker:
    script: worker
    webpack: true
    environment:
      cloudTranslationApiKey: ${env:CLOUD_TRANSLATION_API_KEY}
      iataCodesApiKey: ${env:IATA_CODES_API_KEY}
      sentryProjectId: ${env:SENTRY_PROJECT_ID}
      sentryAPIKey: ${env:SENTRY_API_KEY}
      sentrySecretKey: ${env:SENTRY_SECRET_KEY}
    events:
      - http:
          url: edge.madsstorm.dk/*
          method: GET         
    resources:
      kv:
        - variable: EDGE_STORE
          namespace: edgeNamespace